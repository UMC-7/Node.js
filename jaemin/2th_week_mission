1. 1ì£¼ì°¨ ë•Œ ì„¤ê³„í•œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í† ëŒ€ë¡œ ì•„ë˜ì˜ í™”ë©´ì— ëŒ€í•œ ì¿¼ë¦¬ë¥¼ ì‘ì„±

![ë‚´ê°€ ì§„í–‰ì¤‘, ì§„í–‰ ì™„ë£Œí•œ ë¯¸ì…˜ ëª¨ì•„ì„œ ë³´ëŠ” ì¿¼ë¦¬(í˜ì´ì§• í¬í•¨)](https://prod-files-secure.s3.us-west-2.amazonaws.com/f1912130-0409-4e90-a90f-6091ae253e73/fb2c37cf-9eb2-4e18-b21c-af42c1dd2cc0/Untitled.png)

ë‚´ê°€ ì§„í–‰ì¤‘, ì§„í–‰ ì™„ë£Œí•œ ë¯¸ì…˜ ëª¨ì•„ì„œ ë³´ëŠ” ì¿¼ë¦¬(í˜ì´ì§• í¬í•¨)

```sql
SELECT
		m.score,
		um.status,
		m.description,
		r.name
FROM user_mission um
JOIN mission m ON um.mission_id = m.id
JOIN restaurant r ON m.restaurant_id = r.id
WHERE
		um.user_id = {USER_ID} 
		AND um.status = 'ì§„í–‰ì¤‘'
		AND (um.updated_at < {ë§ˆì§€ë§‰ìœ¼ë¡œ ì¡°íšŒí•œ ë¯¸ì…˜ì˜ ë‚ ì§œ})
ORDER BY um.updated_at DESC
LIMIT 10;

		
```

`cursor paging`ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë‚ ì§œìˆœìœ¼ë¡œ ì •ë ¬í•œë‹¤ê³  ê°€ì • í›„, user_missionì˜ updated_atì„ ì»¤ì„œë¡œ ì‚¬ìš©.

![ë¦¬ë·° ì‘ì„±í•˜ëŠ” ì¿¼ë¦¬,
* ì‚¬ì§„ì˜ ê²½ìš°ëŠ” ì¼ë‹¨ ë°°ì œ](https://prod-files-secure.s3.us-west-2.amazonaws.com/f1912130-0409-4e90-a90f-6091ae253e73/ff64bece-430c-45e4-96fa-de1e40b984db/Untitled.png)

ë¦¬ë·° ì‘ì„±í•˜ëŠ” ì¿¼ë¦¬,
* ì‚¬ì§„ì˜ ê²½ìš°ëŠ” ì¼ë‹¨ ë°°ì œ

```sql
SELECT 
		u.nickname,
		rv.created_at
		rv.rate
		rv.content
FROM review rv
JOIN user u ON rv.user_id = u.id
JOIN restaurant r ON rv.restaurant_id = r.id
WHERE r.id = {RESTAURANT_ID};
		
```

![í™ˆ í™”ë©´ ì¿¼ë¦¬
(í˜„ì¬ ì„ íƒ ëœ ì§€ì—­ì—ì„œ ë„ì „ì´ ê°€ëŠ¥í•œ ë¯¸ì…˜ ëª©ë¡, í˜ì´ì§• í¬í•¨)](https://prod-files-secure.s3.us-west-2.amazonaws.com/f1912130-0409-4e90-a90f-6091ae253e73/6ad90e83-6e2e-4f56-8779-82d16c7f7303/Untitled.png)

í™ˆ í™”ë©´ ì¿¼ë¦¬
(í˜„ì¬ ì„ íƒ ëœ ì§€ì—­ì—ì„œ ë„ì „ì´ ê°€ëŠ¥í•œ ë¯¸ì…˜ ëª©ë¡, í˜ì´ì§• í¬í•¨)

### ì§€ì—­ë³„ ë¯¸ì…˜ ë‹¬ì„± í˜„í™©

```sql
SELECT
		SUM(um.status = 'ì§„í–‰ì™„ë£Œ' THEN 1 ELSE 0 END)
FROM user_mission um
JOIN mission m ON um.mission_id = m.id
JOIN restaurant r ON m.restaurant_id = r.id
JOIN region reg ON r.current_region = reg.id
WHERE
		um.user_id = {USER_ID}
		AND reg.region_name = {ì„ íƒí•œ REGION_NAME};
```

### My Mission

```sql
SELECT
		r.name,
		r.type,
		um.deadline,
		m.description,
		m.score
FROM mission m
JOIN restaurant r ON m.restaurant_id = r.id
JOIN user_mission um ON um.mission_id = m.id
JOIN region reg ON reg.id = r.current_region
WHERE 
		um.user_id = {USER_ID}
		AND reg.region_name = {ì„ íƒí•œ REGION_NAME} 
		AND um.status = 'ì§„í–‰ì¤‘'
		AND (um.updated_at < {ë§ˆì§€ë§‰ìœ¼ë¡œ ì¡°íšŒí•œ ë¯¸ì…˜ì˜ ë‚ ì§œ})
ORDER BY um.updated_at DESC
LIMIT 10;
```

![ë§ˆì´ í˜ì´ì§€ í™”ë©´ ì¿¼ë¦¬](https://prod-files-secure.s3.us-west-2.amazonaws.com/f1912130-0409-4e90-a90f-6091ae253e73/2d736cd4-e3ab-4c55-9b1d-ad818cc22dbf/Untitled.png)

ë§ˆì´ í˜ì´ì§€ í™”ë©´ ì¿¼ë¦¬

```sql
SELECT 
		u.nickname,
    u.email_address,
    CASE 
        WHEN u.phone_num IS NULL THEN 'ë¯¸ì¸ì¦' 
        ELSE u.phone_num
    END u.score
FROM  user u
WHERE u.id = {USER_ID};
    
    
```

```sql
-- COALESCE í•¨ìˆ˜ í™œìš©
SELECT 
    u.nickname,
    u.email_address,
    COALESCE(u.phone_num, 'ë¯¸ì¸ì¦')
    -- ì „í™”ë²ˆí˜¸ê°€ ì—†ìœ¼ë©´ NULL ëŒ€ì‹  'ë¯¸ì¸ì¦' ë°˜í™˜
FROM user u
WHERE u.id = {USER_ID};
```

<aside>
ğŸ’¡

**COALESCE( )**

ë¦¬ìŠ¤íŠ¸ì—ì„œ NULLì´ ì•„ë‹Œ ì²«ë²ˆì§¸ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ - [ì‚¬ìš© ë°©ë²• ë° ì˜ˆì‹œ](https://mollangpiu.tistory.com/456)

</aside>
